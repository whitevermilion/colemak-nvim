return {
  "mfussenegger/nvim-dap",
  ft = { "c" },  -- 只在打开 C 文件时加载
  config = function()
    local dap = require("dap")
    
    -- C 语言专用调试配置
    dap.configurations.c = {
      {
        name = "Launch C (Debug)",
        type = "codelldb",
        request = "launch",
        program = function()
          return vim.fn.input("Path to executable: ", vim.fn.getcwd() .. "/", "file")
        end,
        cwd = "${workspaceFolder}",
        stopOnEntry = false,
        runInTerminal = true,
        args = {},
        env = function()
          local variables = {}
          for k, v in pairs(vim.fn.environ()) do
            table.insert(variables, k .. "=" .. v)
          end
          return variables
        end,
      },
      {
        name = "Launch C (Release)",
        type = "codelldb",
        request = "launch",
        program = function()
          return vim.fn.input("Path to executable: ", vim.fn.getcwd() .. "/", "file")
        end,
        cwd = "${workspaceFolder}",
        stopOnEntry = false,
        runInTerminal = true,
        args = {},
        preLaunchTask = "c-build-release",  -- 可以配合 tasks.json 使用
      },
      {
        name = "Attach to Process",
        type = "codelldb",
        request = "attach",
        pid = function()
          return tonumber(vim.fn.input("Process ID: "))
        end,
      }
    }
  end
}
